<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© - Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Fonts - Inter for general text, Cairo for Arabic -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif; /* Ø®Ø· Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© Ø§Ù„Ù…ÙØ¶Ù„ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ© */
            background-color: #FDFBF7; /* Ø®Ù„ÙÙŠØ© Ø¨ÙŠØ¶Ø§Ø¡ ÙƒØ±ÙŠÙ…ÙŠØ© Ù†Ø§Ø¹Ù…Ø© */
        }
        .inter-font {
            font-family: 'Inter', sans-serif; /* Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø£Ùˆ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… */
        }
        /* Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© Ø§Ù„Ù‡Ø§Ø¯Ø¦Ø© ÙˆØ§Ù„Ù†Ø§Ø¹Ù…Ø© */
        .bg-gradient-header {
            background-image: linear-gradient(to right, #C59D5B, #DAA520); /* Ø°Ù‡Ø¨ÙŠ Ø¨Ø±ÙˆÙ†Ø²ÙŠ Ù„Ø°Ù‡Ø¨ÙŠ Ø£ÙƒØ«Ø± ÙˆØ¶ÙˆØ­Ù‹Ø§ */
        }
        .text-golden-main {
            color: #DAA520; /* Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ Ù…ØªÙˆØ³Ø· */
        }
        .text-golden-dark {
            color: #C59D5B; /* Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ Ø¨Ø±ÙˆÙ†Ø²ÙŠ Ø¯Ø§ÙƒÙ† */
        }
        .bg-golden-button {
            background-color: #DAA520; /* Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ Ù„Ù„Ø£Ø²Ø±Ø§Ø± */
        }
        .hover\:bg-golden-dark:hover {
            background-color: #C59D5B; /* Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ Ø¨Ø±ÙˆÙ†Ø²ÙŠ Ø¯Ø§ÙƒÙ† Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
        }
        .border-golden {
            border-color: #DAA520;
        }
        .bg-light-cream-gold {
            background-color: #EEDBB6; /* Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ ÙØ§ØªØ­ ÙƒØ±ÙŠÙ…ÙŠ Ù„Ù„Ø®Ù„ÙÙŠØ§Øª */
        }
        /* Custom scrollbar for a nicer look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #C59D5B; /* Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ Ù‡Ø§Ø¯Ø¦ */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #DAA520; /* Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ Ø£ØºÙ…Ù‚ Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
        }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #DAA520;
            animation: spin 1s ease infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header Section - Navigation Bar -->
    <header class="bg-gradient-header text-white p-4 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
            <div class="flex items-center space-x-3 rtl:space-x-reverse mb-3 md:mb-0">
                <img src="Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© 1.jpg" onerror="this.onerror=null;this.src='https://placehold.co/64x64/DAA520/ffffff?text=Logo';" alt="Golden Care Logo" class="w-16 h-16 object-cover rounded-full border-2 border-white shadow-md">
                <h1 class="text-3xl font-extrabold tracking-wide">Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©</h1>
            </div>
            <nav>
                <ul class="flex flex-wrap justify-center md:space-x-6 rtl:space-x-reverse space-x-3 text-lg font-medium">
                    <li><a href="index.html" class="hover:text-amber-200 transition duration-300">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
                    <li><a href="about.html" class="hover:text-amber-200 transition duration-300">Ù…Ù† Ù†Ø­Ù†</a></li>
                    <li><a href="services.html" class="hover:text-amber-200 transition duration-300">Ø®Ø¯Ù…Ø§ØªÙ†Ø§</a></li>
                    <li><a href="team.html" class="hover:text-amber-200 transition duration-300">ÙØ±ÙŠÙ‚Ù†Ø§</a></li>
                    <li><a href="history.html" class="hover:text-amber-200 transition duration-300">ØªØ§Ø±ÙŠØ®Ù†Ø§</a></li>
                    <li><a href="jobs.html" class="hover:text-amber-200 transition duration-300">ÙˆØ¸Ø§Ø¦Ù</a></li>
                    <li><a href="privacy.html" class="hover:text-amber-200 transition duration-300">Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a></li>
                    <li><a href="contact.html" class="hover:text-amber-200 transition duration-300">Ø§ØªØµÙ„ Ø¨Ù†Ø§</a></li>
                    <li><a href="ai_tools.html" class="hover:text-amber-200 transition duration-300">Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Page Content - AI Tools -->
    <main class="py-16 bg-light-cream-gold px-6 min-h-screen">
        <div class="container mx-auto max-w-4xl bg-white p-8 rounded-xl shadow-lg border border-golden">
            <h2 class="text-5xl font-extrabold text-golden-dark text-center mb-12">
                Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© ğŸ¤–
            </h2>
            <p class="text-lg leading-relaxed text-gray-700 mb-8 text-center">
                Ø§ÙƒØªØ´Ù Ù‚ÙˆØ© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„ØªÙˆÙ„ÙŠØ¯ ØµÙˆØ± ÙØ±ÙŠØ¯Ø© ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ Ø¥Ù„Ù‰ ÙƒÙ„Ø§Ù… Ù…Ø³Ù…ÙˆØ¹ Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©.
            </p>

            <!-- Image Generation Section -->
            <section class="mb-12 p-6 bg-light-cream-gold rounded-lg shadow-md border-b-4 border-golden">
                <h3 class="text-4xl font-bold text-golden-dark mb-6 text-right">
                    ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ± Ù…Ù† Ø§Ù„Ù†Øµ ğŸ–¼ï¸
                </h3>
                <p class="text-md leading-relaxed text-gray-700 mb-6 text-right">
                    Ø£Ø¯Ø®Ù„ ÙˆØµÙÙ‹Ø§ ØªÙØµÙŠÙ„ÙŠÙ‹Ø§ Ù„Ù„ØµÙˆØ±Ø© Ø§Ù„ØªÙŠ ØªØ±ØºØ¨ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¦Ù‡Ø§ØŒ ÙˆØ³ÙŠÙ‚ÙˆÙ… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø¨ØªØ­ÙˆÙŠÙ„ ÙƒÙ„Ù…Ø§ØªÙƒ Ø¥Ù„Ù‰ ØªØ­ÙØ© Ø¨ØµØ±ÙŠØ©.
                </p>
                <div class="mb-4">
                    <label for="imagePrompt" class="block text-gray-700 text-lg font-bold mb-2">ÙˆØµÙ Ø§Ù„ØµÙˆØ±Ø©:</label>
                    <textarea id="imagePrompt" class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline focus:border-golden-main" rows="4" placeholder="Ù…Ø«Ø§Ù„: Ù‚Ø·Ø© Ù„Ø·ÙŠÙØ© ØªØ±ØªØ¯ÙŠ Ù‚Ø¨Ø¹Ø© ØµØºÙŠØ±Ø© ÙˆØªØ¬Ù„Ø³ Ø¹Ù„Ù‰ Ø£Ø±Ø¬ÙˆØ­Ø© ÙÙŠ Ø­Ø¯ÙŠÙ‚Ø© Ø®Ø¶Ø±Ø§Ø¡ Ù…Ø´Ø±Ù‚Ø©."></textarea>
                </div>
                <button id="generateImageBtn" class="bg-golden-button hover:bg-golden-dark text-white font-bold py-3 px-8 rounded-full shadow-lg transform hover:scale-105 transition duration-300 flex items-center justify-center">
                    ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ±Ø© <i class="fas fa-magic mr-2 rtl:ml-2 rtl:mr-0"></i>
                    <span id="imageSpinner" class="spinner hidden mr-2 rtl:ml-2 rtl:mr-0"></span>
                </button>
                <div id="imageResult" class="mt-8 text-center bg-white p-4 rounded-lg shadow-inner">
                    <!-- Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù†Ø§ØªØ¬Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                    <p id="imageMessage" class="text-gray-500">Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…ÙˆÙ„Ø¯Ø© Ù‡Ù†Ø§.</p>
                </div>
            </section>

            <!-- Text-to-Speech Section -->
            <section class="mb-12 p-6 bg-light-cream-gold rounded-lg shadow-md border-b-4 border-golden">
                <h3 class="text-4xl font-bold text-golden-dark mb-6 text-right">
                    ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø¥Ù„Ù‰ ØµÙˆØª ğŸ”Š
                </h3>
                <p class="text-md leading-relaxed text-gray-700 mb-6 text-right">
                    Ø§ÙƒØªØ¨ Ø£ÙŠ Ù†Øµ ØªØ±ØºØ¨ ÙÙŠ ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ ÙƒÙ„Ø§Ù… Ù…Ø³Ù…ÙˆØ¹. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ù†Ø¨Ø±Ø© Ø§Ù„ØµÙˆØª Ø£Ùˆ Ù„Ù‡Ø¬ØªÙ‡.
                </p>
                <div class="mb-4">
                    <label for="ttsText" class="block text-gray-700 text-lg font-bold mb-2">Ø§Ù„Ù†Øµ Ù„Ù„ØµÙˆØª:</label>
                    <textarea id="ttsText" class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline focus:border-golden-main" rows="4" placeholder="Ù…Ø«Ø§Ù„: Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©ØŒ Ø­ÙŠØ« Ù†Ù‚Ø¯Ù… Ù„Ùƒ Ø£ÙØ¶Ù„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª."></textarea>
                </div>
                <div class="mb-6">
                    <label for="voiceSelect" class="block text-gray-700 text-lg font-bold mb-2">Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØª (Ø§Ù„Ù†Ø¨Ø±Ø©/Ø§Ù„Ù„Ù‡Ø¬Ø©):</label>
                    <select id="voiceSelect" class="block w-full bg-white border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-golden-main">
                        <option value="Kore">ÙƒÙˆØ±ÙŠ (Kore) - Ù†Ø¨Ø±Ø© Ø«Ø§Ø¨ØªØ©</option>
                        <option value="Puck">Ø¨Ø§Ùƒ (Puck) - Ù†Ø¨Ø±Ø© Ù…Ø±Ø­Ø©</option>
                        <option value="Zephyr">Ø²ÙÙŠØ± (Zephyr) - Ù†Ø¨Ø±Ø© Ù…Ø´Ø±Ù‚Ø©</option>
                        <option value="Charon">Ø´Ø§Ø±ÙˆÙ† (Charon) - Ù†Ø¨Ø±Ø© Ø¥Ø®Ø¨Ø§Ø±ÙŠØ©</option>
                        <option value="Fenrir">ÙÙ†Ø±ÙŠØ± (Fenrir) - Ù†Ø¨Ø±Ø© Ø­Ù…Ø§Ø³ÙŠØ©</option>
                        <option value="Leda">Ù„ÙŠØ¯Ø§ (Leda) - Ù†Ø¨Ø±Ø© Ø´Ø§Ø¨Ø©</option>
                        <option value="Orus">Ø£ÙˆØ±ÙˆØ³ (Orus) - Ù†Ø¨Ø±Ø© Ø­Ø§Ø²Ù…Ø©</option>
                        <option value="Aoede">Ø£ÙˆÙŠØ¯ (Aoede) - Ù†Ø¨Ø±Ø© Ø³Ù„Ø³Ø©</option>
                        <option value="Callirrhoe">ÙƒØ§Ù„ÙŠØ±ÙˆÙŠ (Callirrhoe) - Ù†Ø¨Ø±Ø© Ø³Ù‡Ù„Ø©</option>
                        <option value="Autonoe">Ø£ÙˆØªÙˆÙ†ÙˆÙŠ (Autonoe) - Ù†Ø¨Ø±Ø© Ù…Ø´Ø±Ù‚Ø©</option>
                        <option value="Enceladus">Ø¥Ù†Ø³ÙŠÙ„Ø§Ø¯ÙˆØ³ (Enceladus) - Ù†Ø¨Ø±Ø© ØªÙ†ÙØ³ÙŠØ©</option>
                        <option value="Iapetus">Ø¥ÙŠØ§Ø¨ÙŠØªÙˆØ³ (Iapetus) - Ù†Ø¨Ø±Ø© ÙˆØ§Ø¶Ø­Ø©</option>
                        <option value="Umbriel">Ø£ÙˆÙ…Ø¨Ø±ÙŠÙ„ (Umbriel) - Ù†Ø¨Ø±Ø© Ø³Ù‡Ù„Ø©</option>
                        <option value="Algieba">Ø£Ù„Ø¬ÙŠØ¨Ø§ (Algieba) - Ù†Ø¨Ø±Ø© Ø³Ù„Ø³Ø©</option>
                        <option value="Despina">Ø¯ÙŠØ³Ø¨ÙŠÙ†Ø§ (Despina) - Ù†Ø¨Ø±Ø© Ø³Ù„Ø³Ø©</option>
                        <option value="Erinome">Ø¥Ø±ÙŠÙ†ÙˆÙ… (Erinome) - Ù†Ø¨Ø±Ø© ÙˆØ§Ø¶Ø­Ø©</option>
                        <option value="Algenib">Ø£Ù„Ø¬Ù†ÙŠØ¨ (Algenib) - Ù†Ø¨Ø±Ø© Ø®Ø´Ù†Ø©</option>
                        <option value="Rasalgethi">Ø±Ø§Ø³Ø§Ù„Ø¬ÙŠØ«ÙŠ (Rasalgethi) - Ù†Ø¨Ø±Ø© Ø¥Ø®Ø¨Ø§Ø±ÙŠØ©</option>
                        <option value="Laomedeia">Ù„Ø§ÙˆÙ…ÙŠØ¯ÙŠØ§ (Laomedeia) - Ù†Ø¨Ø±Ø© Ù…Ø±Ø­Ø©</option>
                        <option value="Achernar">Ø£Ø®ÙŠØ±Ù†Ø§Ø± (Achernar) - Ù†Ø¨Ø±Ø© Ù†Ø§Ø¹Ù…Ø©</option>
                        <option value="Alnilam">Ø£Ù„Ù†ÙŠÙ„Ø§Ù† (Alnilam) - Ù†Ø¨Ø±Ø© Ø«Ø§Ø¨ØªØ©</option>
                        <option value="Schedar">Ø´ÙŠØ¯Ø§Ø± (Schedar) - Ù†Ø¨Ø±Ø© Ù…ØªÙˆØ§Ø²Ù†Ø©</option>
                        <option value="Gacrux">Ø¬Ø§ÙƒØ±ÙˆÙƒØ³ (Gacrux) - Ù†Ø¨Ø±Ø© Ù†Ø§Ø¶Ø¬Ø©</option>
                        <option value="Pulcherrima">Ø¨ÙˆÙ„Ø´ÙŠØ±ÙŠÙ…Ø§ (Pulcherrima) - Ù†Ø¨Ø±Ø© Ø¬Ø±ÙŠØ¦Ø©</option>
                        <option value="Achird">Ø£Ø´ÙŠØ±Ø¯ (Achird) - Ù†Ø¨Ø±Ø© ÙˆØ¯ÙˆØ¯Ø©</option>
                        <option value="Zubenelgenubi">Ø²ÙˆØ¨ÙŠÙ†Ù„Ø¬Ù†ÙˆØ¨ÙŠ (Zubenelgenubi) - Ù†Ø¨Ø±Ø© Ø¹Ø§Ø¯ÙŠØ©</option>
                        <option value="Vindemiatrix">ÙÙŠÙ†Ø¯Ù…ÙŠØ§ØªØ±ÙŠÙƒØ³ (Vindemiatrix) - Ù†Ø¨Ø±Ø© Ù„Ø·ÙŠÙØ©</option>
                        <option value="Sadachbia">Ø³Ø§Ø¯Ø§Ø´Ø¨ÙŠØ§ (Sadachbia) - Ù†Ø¨Ø±Ø© Ø­ÙŠÙˆÙŠØ©</option>
                        <option value="Sadaltager">Ø³Ø§Ø¯Ø§Ù„ØªØ§Ø¬ÙŠØ± (Sadaltager) - Ù†Ø¨Ø±Ø© Ù…Ø¹Ø±ÙÙŠØ©</option>
                        <option value="Sulafat">Ø³ÙˆÙ„Ø§ÙØ§Øª (Sulafat) - Ù†Ø¨Ø±Ø© Ø¯Ø§ÙØ¦Ø©</option>
                    </select>
                </div>
                <button id="generateTtsBtn" class="bg-golden-button hover:bg-golden-dark text-white font-bold py-3 px-8 rounded-full shadow-lg transform hover:scale-105 transition duration-300 flex items-center justify-center">
                    ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ØµÙˆØª <i class="fas fa-play-circle mr-2 rtl:ml-2 rtl:mr-0"></i>
                    <span id="ttsSpinner" class="spinner hidden mr-2 rtl:ml-2 rtl:mr-0"></span>
                </button>
                <div id="ttsResult" class="mt-8 text-center bg-white p-4 rounded-lg shadow-inner">
                    <!-- Ù…Ø´ØºÙ„ Ø§Ù„ØµÙˆØª Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                    <p id="ttsMessage" class="text-gray-500">Ø³ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ù‡Ù†Ø§.</p>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer Section -->
    <footer class="bg-gray-900 text-gray-300 py-8 px-6">
        <div class="container mx-auto text-center">
            <p class="mb-4">&copy; 2025 Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
            <div class="flex justify-center space-x-6 rtl:space-x-reverse">
                <a href="#" class="hover:text-golden-main transition duration-300"><i class="fab fa-facebook-f text-xl"></i></a>
                <a href="#" class="hover:text-golden-main transition duration-300"><i class="fab fa-twitter text-xl"></i></a>
                <a href="#" class="hover:text-golden-main transition duration-300"><i class="fab fa-linkedin-in text-xl"></i></a>
                <a href="#" class="hover:text-golden-main transition duration-300"><i class="fab fa-instagram text-xl"></i></a>
            </div>
            <p class="mt-4 text-sm opacity-75">
                ØªØµÙ…ÙŠÙ… ÙˆØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© ÙØ±ÙŠÙ‚ Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©
            </p>
        </div>
    </footer>

    <script>
        // Ø¯Ø§Ù„Ø© Ù„ØªØ­ÙˆÙŠÙ„ Base64 Ø¥Ù„Ù‰ ArrayBuffer (Ù„ØªØ­ÙˆÙŠÙ„ PCM Ø¥Ù„Ù‰ WAV)
        function base64ToArrayBuffer(base64) {
            const binaryString = atob(base64);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes.buffer;
        }

        // Ø¯Ø§Ù„Ø© Ù„ØªØ­ÙˆÙŠÙ„ PCM Ø¥Ù„Ù‰ WAV
        function pcmToWav(pcm16Data, sampleRate) {
            const pcmData = pcm16Data.buffer;
            const numChannels = 1; // PCM is typically mono
            const bytesPerSample = 2; // 16-bit PCM

            const wavHeader = new ArrayBuffer(44);
            const view = new DataView(wavHeader);

            // RIFF chunk descriptor
            writeString(view, 0, 'RIFF'); // ChunkID
            view.setUint32(4, 36 + pcmData.byteLength, true); // ChunkSize
            writeString(view, 8, 'WAVE'); // Format

            // FMT sub-chunk
            writeString(view, 12, 'fmt '); // Subchunk1ID
            view.setUint32(16, 16, true); // Subchunk1Size (16 for PCM)
            view.setUint16(20, 1, true); // AudioFormat (1 for PCM)
            view.setUint16(22, numChannels, true); // NumChannels
            view.setUint32(24, sampleRate, true); // SampleRate
            view.setUint32(28, sampleRate * numChannels * bytesPerSample, true); // ByteRate
            view.setUint16(32, numChannels * bytesPerSample, true); // BlockAlign
            view.setUint16(34, bytesPerSample * 8, true); // BitsPerSample

            // DATA sub-chunk
            writeString(view, 36, 'data'); // Subchunk2ID
            view.setUint32(40, pcmData.byteLength, true); // Subchunk2Size

            const blob = new Blob([wavHeader, pcmData], { type: 'audio/wav' });
            return blob;
        }

        function writeString(view, offset, string) {
            for (let i = 0; i < string.length; i++) {
                view.setUint8(offset + i, string.charCodeAt(i));
            }
        }

        // --- Image Generation Logic ---
        const generateImageBtn = document.getElementById('generateImageBtn');
        const imagePromptInput = document.getElementById('imagePrompt');
        const imageResultDiv = document.getElementById('imageResult');
        const imageMessageP = document.getElementById('imageMessage');
        const imageSpinner = document.getElementById('imageSpinner');

        generateImageBtn.addEventListener('click', async () => {
            const prompt = imagePromptInput.value.trim();
            if (!prompt) {
                imageMessageP.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙˆØµÙ Ù„Ù„ØµÙˆØ±Ø©.';
                imageMessageP.classList.remove('text-gray-500', 'text-green-600', 'text-red-600');
                imageMessageP.classList.add('text-red-600');
                return;
            }

            // Show loading spinner and clear previous results
            imageSpinner.classList.remove('hidden');
            generateImageBtn.disabled = true;
            imageResultDiv.innerHTML = `<p id="imageMessage" class="text-gray-500">Ø¬Ø§Ø±Ù ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ±Ø©ØŒ Ù‚Ø¯ ÙŠØ³ØªØºØ±Ù‚ Ø§Ù„Ø£Ù…Ø± Ø¨Ø¹Ø¶ Ø§Ù„ÙˆÙ‚Øª...</p>`;

            // Exponential backoff retry mechanism
            let retries = 0;
            const maxRetries = 5;
            const baseDelay = 1000; // 1 second

            while (retries < maxRetries) {
                try {
                    const payload = {
                        instances: { prompt: prompt },
                        parameters: { "sampleCount": 1 }
                    };
                    // The apiKey is automatically provided by Canvas when it's an empty string.
                    const apiKey = "";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict?key=${apiKey}`;

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    const result = await response.json();

                    if (result.predictions && result.predictions.length > 0 && result.predictions[0].bytesBase64Encoded) {
                        const imageUrl = `data:image/png;base64,${result.predictions[0].bytesBase64Encoded}`;
                        imageResultDiv.innerHTML = `<img src="${imageUrl}" alt="Generated Image" class="w-full h-auto rounded-lg shadow-md mx-auto max-w-sm" onerror="this.onerror=null;this.src='https://placehold.co/400x300/C59D5B/ffffff?text=Image+Error';" />`;
                        imageMessageP.textContent = ''; // Clear message
                        break; // Exit retry loop on success
                    } else {
                        imageResultDiv.innerHTML = `<p id="imageMessage" class="text-red-600">ÙØ´Ù„ ÙÙŠ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ±Ø©: ${result.error?.message || 'Ø§Ø³ØªØ¬Ø§Ø¨Ø© ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹Ø©.'}</p>`;
                        console.error('Image generation error:', result);
                        // If it's a transient error, retry
                        if (response.status >= 500 || response.status === 429) { // 5xx for server errors, 429 for too many requests
                            retries++;
                            const delay = baseDelay * Math.pow(2, retries);
                            await new Promise(res => setTimeout(res, delay));
                        } else {
                            break; // Do not retry for client errors
                        }
                    }
                } catch (error) {
                    console.error('Fetch error during image generation:', error);
                    imageResultDiv.innerHTML = `<p id="imageMessage" class="text-red-600">Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„: ${error.message}.</p>`;
                    retries++;
                    const delay = baseDelay * Math.pow(2, retries);
                    await new Promise(res => setTimeout(res, delay));
                }
            }

            if (retries === maxRetries) {
                imageResultDiv.innerHTML = `<p id="imageMessage" class="text-red-600">ÙØ´Ù„ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø¹Ø¯ Ø¹Ø¯Ø© Ù…Ø­Ø§ÙˆÙ„Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§.</p>`;
            }

            imageSpinner.classList.add('hidden');
            generateImageBtn.disabled = false;
        });

        // --- Text-to-Speech Logic ---
        const generateTtsBtn = document.getElementById('generateTtsBtn');
        const ttsTextInput = document.getElementById('ttsText');
        const voiceSelect = document.getElementById('voiceSelect');
        const ttsResultDiv = document.getElementById('ttsResult');
        const ttsMessageP = document.getElementById('ttsMessage');
        const ttsSpinner = document.getElementById('ttsSpinner');

        generateTtsBtn.addEventListener('click', async () => {
            const text = ttsTextInput.value.trim();
            const selectedVoice = voiceSelect.value;
            if (!text) {
                ttsMessageP.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ù„ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ ØµÙˆØª.';
                ttsMessageP.classList.remove('text-gray-500', 'text-green-600', 'text-red-600');
                ttsMessageP.classList.add('text-red-600');
                return;
            }

            // Show loading spinner and clear previous results
            ttsSpinner.classList.remove('hidden');
            generateTtsBtn.disabled = true;
            ttsResultDiv.innerHTML = `<p id="ttsMessage" class="text-gray-500">Ø¬Ø§Ø±Ù ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ØµÙˆØªØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...</p>`;

            let retries = 0;
            const maxRetries = 5;
            const baseDelay = 1000; // 1 second

            while (retries < maxRetries) {
                try {
                    const payload = {
                        contents: [{
                            parts: [{ text: text }]
                        }],
                        generationConfig: {
                            responseModalities: ["AUDIO"],
                            speechConfig: {
                                voiceConfig: {
                                    prebuiltVoiceConfig: { voiceName: selectedVoice }
                                }
                            }
                        },
                        model: "gemini-2.5-flash-preview-tts"
                    };

                    const apiKey = ""; // Canvas provides this automatically
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    const result = await response.json();
                    const part = result?.candidates?.[0]?.content?.parts?.[0];
                    const audioData = part?.inlineData?.data;
                    const mimeType = part?.inlineData?.mimeType;

                    if (audioData && mimeType && mimeType.startsWith("audio/L16")) {
                        // Extract sample rate from mimeType if available, default to 16000
                        const match = mimeType.match(/rate=(\d+)/);
                        const sampleRate = match ? parseInt(match[1], 10) : 16000;

                        const pcmData = base64ToArrayBuffer(audioData);
                        const pcm16 = new Int16Array(pcmData); // PCM 16-bit signed

                        const wavBlob = pcmToWav(pcm16, sampleRate);
                        const audioUrl = URL.createObjectURL(wavBlob);

                        ttsResultDiv.innerHTML = `<audio controls src="${audioUrl}" class="w-full mt-4"></audio>`;
                        ttsMessageP.textContent = 'ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ØµÙˆØª Ø¨Ù†Ø¬Ø§Ø­.';
                        ttsMessageP.classList.remove('text-gray-500', 'text-red-600');
                        ttsMessageP.classList.add('text-green-600');
                        break; // Exit retry loop on success
                    } else {
                        ttsResultDiv.innerHTML = `<p id="ttsMessage" class="text-red-600">ÙØ´Ù„ ÙÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ØµÙˆØª: ${result.error?.message || 'Ø§Ø³ØªØ¬Ø§Ø¨Ø© ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹Ø© Ø£Ùˆ ØªÙ†Ø³ÙŠÙ‚ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ….'}</p>`;
                        console.error('TTS error:', result);
                        // If it's a transient error, retry
                        if (response.status >= 500 || response.status === 429) {
                            retries++;
                            const delay = baseDelay * Math.pow(2, retries);
                            await new Promise(res => setTimeout(res, delay));
                        } else {
                            break; // Do not retry for client errors
                        }
                    }
                } catch (error) {
                    console.error('Fetch error during TTS:', error);
                    ttsResultDiv.innerHTML = `<p id="ttsMessage" class="text-red-600">Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„: ${error.message}.</p>`;
                    retries++;
                    const delay = baseDelay * Math.pow(2, retries);
                    await new Promise(res => setTimeout(res, delay));
                }
            }

            if (retries === maxRetries) {
                ttsResultDiv.innerHTML = `<p id="ttsMessage" class="text-red-600">ÙØ´Ù„ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ØµÙˆØª Ø¨Ø¹Ø¯ Ø¹Ø¯Ø© Ù…Ø­Ø§ÙˆÙ„Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§.</p>`;
            }

            ttsSpinner.classList.add('hidden');
            generateTtsBtn.disabled = false;
        });

    </script>
</body>
</html>
